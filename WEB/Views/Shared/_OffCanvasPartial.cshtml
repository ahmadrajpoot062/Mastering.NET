@using System.Linq
@model List<TopicLectureViewModel>

<div class="offcanvas-body">
    <!-- Professional looking dropdown menu for Tutorials -->
    <ul class="list-group list-group-flush">
        @foreach (var tutorial in Model)
        {
            <li class="list-group-item dropdown">
                <div class="d-flex align-items-start">
                    <i class="bi bi-arrow-right-circle bullet-icon"></i>
                    <a href="#" class="dropdown-toggle text-wrap ms-2" data-bs-toggle="collapse"
                       data-bs-target="#@tutorial.Topic.Id">
                        @tutorial.Topic.TopicName                        
                    </a>
                    @if (User.Identity.Name == "admin231@gmail.com")
                    {
                        <i class="bi bi-trash delete-tutorial-icon text-danger" data-tutorial-id="@tutorial.Topic.Id" data-bs-toggle="modal" data-bs-target="#confirmDeleteTutorialModal"
                           title="Delete" style="cursor: pointer;"></i>
                    }
                </div>
                <ul id="@tutorial.Topic.Id" class="collapse list-group list-group-flush">
                    @if (User.Identity.Name == "admin231@gmail.com")
                    {
                        <!-- Admin can upload tutorial notes -->
                        <li class="list-group-item d-flex align-items-center">
                            <a type="button" class="btn btn-link upload-pdf-icon" data-bs-toggle="modal"
                               data-bs-target="#uploadPdfModal" data-tutorial-id="@tutorial.Topic.Id">
                                <i class="bi bi-upload me-2"></i> Upload Tutorial Notes
                            </a>
                        </li>
                    }

                    @if (!tutorial.Lectures?.Any() ?? true)
                    {
                        <!-- Only show if user is not the admin -->
                        @if (User.Identity.Name != "admin231@gmail.com")
                        {
                            <li class="list-group-item d-flex align-items-center text-secondary ms-2">
                                No Tutorial Notes yet
                            </li>
                        }
                    }
                    else
                    {
                        @foreach (var lecture in tutorial.Lectures)
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                <div class="d-flex align-items-center flex-grow-1 me-2">
                                    <i class="bi bi-dot fs-4" style="color: #75B3C9;"></i>
                                    <!-- Pass both filePath and fileName as query string parameters -->
                                    <a href="@Url.Action("viewNotes", "Home", new { filePath = lecture.FilePath, fileName = lecture.LectureTitle })" target="_blank" class="ms-2">@lecture.LectureTitle</a>
                                </div>
                                @if (User.Identity.Name == "admin231@gmail.com")
                                {
                                    <!-- Add data-lecture-id attribute to store the LectureId -->
                                    <i class="bi bi-trash delete-icon text-danger" data-lecture-id="@lecture.Id" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"
                                       title="Delete" style="cursor: pointer;"></i>
                                }
                            </li>
                        }
                    }

                </ul>

            </li>
        }
    </ul>
</div>
